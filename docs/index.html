<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>EBS Pricing Table</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	</head>
	<body>

		<div class="container mt-5">
			<div class="row justify-content-md-center">
				<div class="col col-9">

					<h1 class="text-center">AWS EBS Pricing across regions</h1>

					<table class="table container mt-3" id="table">
						<thead>
							<tr>
								<th data-field="region">region</th>
								<th data-field="gp2">gp2</th>
								<th data-field="io1">io1</th>
								<th data-field="st1">st1</th>
								<th data-field="sc1">sc1</th>
								<th data-field="standard">standard</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>

				</div>
			</div>
		</div>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

		<script>
			async function loadData() {
				const res_regions = await fetch('https://cloudkeep-io.github.io/ebs-pricing/aws.regions.json');
				const regions = await res_regions.json();
				const res_prices = await fetch('https://cloudkeep-io.github.io/ebs-pricing/aws.ebs_pricing.json');
				const prices = await res_prices.json();
				console.log(regions);
				console.log(prices);
				const tbodyElement = document.getElementById('table').getElementsByTagName('tbody')[0];
				Object.entries(regions).forEach(([region, info]) => {
					const row = tbodyElement.insertRow(-1);
					var region_cell = row.insertCell(0);
					region_cell.innerHTML = region + '<br/>' + '<small>' + info['description'] + '</small>';
					var gp2_cell = row.insertCell(1);
					gp2_cell.innerHTML = '$' + prices['gp2'][region]['price_per_GiB']['USD'] + '/GiB'
				})
			};
			(function () {
				loadData();
			})();
		</script>


	</body>
</html>
